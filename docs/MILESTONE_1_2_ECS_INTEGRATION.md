# Milestone 1.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è EnTT (ECS Architecture)

**–î–∞—Ç–∞:** 2025-11-16
**–í–µ—Ä—Å–∏—è:** 0.1.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## –û–±–∑–æ—Ä

Milestone 1.2 –¥–æ–±–∞–≤–ª—è–µ—Ç Entity Component System (ECS) –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ EnTT. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —ç—Ç–∞–ø –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–∏–±–∫–æ–π –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–≤—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

---

## –ó–∞–¥–∞—á–∏ Milestone 1.2

- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è EnTT
- [x] –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Transform, Sprite, Velocity, Camera)
- [x] –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (RenderSystem)
- [x] –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (UpdateSystem)
- [x] –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ResourceManager –¥–ª—è —Ç–µ–∫—Å—Ç—É—Ä
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ECS

### –ü—Ä–∏–Ω—Ü–∏–ø—ã

**ECS (Entity Component System)** - —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω, –≥–¥–µ:
- **Entity (–°—É—â–Ω–æ—Å—Ç—å)** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞
- **Component (–ö–æ–º–ø–æ–Ω–µ–Ω—Ç)** - –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ª–æ–≥–∏–∫–∏
- **System (–°–∏—Å—Ç–µ–º–∞)** - –ª–æ–≥–∏–∫–∞ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: Cache-friendly –∏—Ç–µ—Ä–∞—Ü–∏—è
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–∏–∫–∏

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. TransformComponent

–ë–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.

```cpp
struct TransformComponent {
    float x = 0.0f;              ///< –ü–æ–∑–∏—Ü–∏—è X –≤ –ø–∏–∫—Å–µ–ª—è—Ö
    float y = 0.0f;              ///< –ü–æ–∑–∏—Ü–∏—è Y –≤ –ø–∏–∫—Å–µ–ª—è—Ö
    float rotation = 0.0f;       ///< –£–≥–æ–ª –ø–æ–≤–æ—Ä–æ—Ç–∞ –≤ –≥—Ä–∞–¥—É—Å–∞—Ö
    float scaleX = 1.0f;         ///< –ú–∞—Å—à—Ç–∞–± –ø–æ X
    float scaleY = 1.0f;         ///< –ú–∞—Å—à—Ç–∞–± –ø–æ Y
};
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å—Ü–µ–Ω–µ
- –í—Ä–∞—â–µ–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ë–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö –≤–∏–¥–∏–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

### 2. SpriteComponent

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç—É—Ä—É.

```cpp
struct SpriteComponent {
    std::string textureName;     ///< –ò–º—è —Ç–µ–∫—Å—Ç—É—Ä—ã –≤ ResourceManager
    sf::IntRect textureRect;     ///< –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Ç–µ–∫—Å—Ç—É—Ä—ã (–¥–ª—è –∞—Ç–ª–∞—Å–æ–≤)
    sf::Color color;             ///< –¶–≤–µ—Ç –º–æ–¥—É–ª—è—Ü–∏–∏
    int layer = 0;               ///< –°–ª–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
    bool visible = true;         ///< –í–∏–¥–∏–º–æ—Å—Ç—å —Å–ø—Ä–∞–π—Ç–∞
};
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ø—Ä–∞–π—Ç-–∞—Ç–ª–∞—Å–æ–≤ —á–µ—Ä–µ–∑ `textureRect`
- –¶–≤–µ—Ç–æ–≤–∞—è –º–æ–¥—É–ª—è—Ü–∏—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –°–∏—Å—Ç–µ–º–∞ —Å–ª–æ–µ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–æ–º –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
- –§–ª–∞–≥ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è

### 3. VelocityComponent

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∏ —É–≥–ª–æ–≤–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è.

```cpp
struct VelocityComponent {
    float vx = 0.0f;             ///< –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ X (–ø–∏–∫—Å–µ–ª–µ–π/—Å–µ–∫—É–Ω–¥—É)
    float vy = 0.0f;             ///< –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ Y (–ø–∏–∫—Å–µ–ª–µ–π/—Å–µ–∫—É–Ω–¥—É)
    float angularVelocity = 0.0f; ///< –£–≥–ª–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (–≥—Ä–∞–¥—É—Å–æ–≤/—Å–µ–∫—É–Ω–¥—É)
};
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ—Å—Ç–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –±–µ–∑ —Ñ–∏–∑–∏–∫–∏
- –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
- –ë–∞–∑–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤

### 4. CameraComponent

–¢–µ–≥-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã.

```cpp
struct CameraComponent {
    float zoom = 1.0f;           ///< –ú–∞—Å—à—Ç–∞–± –∫–∞–º–µ—Ä—ã
    bool active = true;          ///< –ê–∫—Ç–∏–≤–Ω–∞ –ª–∏ –∫–∞–º–µ—Ä–∞
};
```

**–ü–ª–∞–Ω—ã:**
- –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞ –æ–±—ä–µ–∫—Ç–æ–º
- –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º —É—Ä–æ–≤–Ω—è

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –°–∏—Å—Ç–µ–º—ã

### RenderSystem

–°–∏—Å—Ç–µ–º–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–ª–æ—è–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SFML 3.0 API (Vector2f, sf::Angle)
- –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ origin –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—Ä–∞—â–µ–Ω–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç—É—Ä

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –°–æ–±—Ä–∞—Ç—å –≤—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏ —Å Transform + Sprite
2. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –Ω–µ–≤–∏–¥–∏–º—ã–µ (visible = false)
3. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å–ª–æ—è–º (layer)
4. –î–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏:
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—Å—Ç—É—Ä—É –∏–∑ ResourceManager
   - –°–æ–∑–¥–∞—Ç—å SFML —Å–ø—Ä–∞–π—Ç
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
   - –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**
```cpp
// –í GameState::render()
if (m_renderSystem) {
    m_renderSystem->render(m_registry, window);
}
```

### UpdateSystem

–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —É–≥–ª–æ–≤ –≤—Ä–∞—â–µ–Ω–∏—è (0-360¬∞)
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π timestep –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º –¥–≤–∏–∂–µ–Ω–∏—è:**
```cpp
transform.x += velocity.vx * dt;
transform.y += velocity.vy * dt;
transform.rotation += velocity.angularVelocity * dt;
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```cpp
// –í GameState::update(double dt)
if (m_updateSystem) {
    m_updateSystem->update(m_registry, dt);
}
```

---

## ResourceManager: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¢–µ–∫—Å—Ç—É—Ä

### –ù–æ–≤—ã–µ –ú–µ—Ç–æ–¥—ã

#### loadTextureFromImage()
–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä—ã –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

```cpp
bool ResourceManager::loadTextureFromImage(const std::string& name, const sf::Image& image);
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```cpp
// –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
sf::Image testImage(sf::Vector2u(64, 64), sf::Color::Red);

// –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ ResourceManager
resources->loadTextureFromImage("test_square", testImage);
```

#### getTexture()
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π.

```cpp
const sf::Texture& ResourceManager::getTexture(const std::string& path);
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ `std::unordered_map<std::string, sf::Texture>`:
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é —Ç–µ–∫—Å—Ç—É—Ä—É
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø O(1)

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ GameState

### –ß–ª–µ–Ω—ã –ö–ª–∞—Å—Å–∞

```cpp
private:
    entt::registry m_registry;                 ///< EnTT registry
    std::unique_ptr<RenderSystem> m_renderSystem;  ///< –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    std::unique_ptr<UpdateSystem> m_updateSystem;  ///< –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```cpp
void GameState::initializeScene() {
    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º
    m_renderSystem = std::make_unique<RenderSystem>(resources);
    m_updateSystem = std::make_unique<UpdateSystem>();

    // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Ç–µ–∫—Å—Ç—É—Ä—ã
    sf::Image testImage(sf::Vector2u(64, 64), sf::Color::Red);
    resources->loadTextureFromImage("test_square", testImage);

    // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
    for (int i = 0; i < 3; ++i) {
        auto entity = m_registry.create();

        auto& transform = m_registry.emplace<TransformComponent>(entity);
        transform.x = 200.0f + i * 150.0f;
        transform.y = 300.0f;

        auto& sprite = m_registry.emplace<SpriteComponent>(entity);
        sprite.textureName = "test_square";

        auto& velocity = m_registry.emplace<VelocityComponent>(entity);
        velocity.vx = 50.0f * (i % 2 == 0 ? 1.0f : -1.0f);
        velocity.angularVelocity = 45.0f * (i + 1);
    }
}
```

### –ò–≥—Ä–æ–≤–æ–π –¶–∏–∫–ª

```cpp
void GameState::update(double dt) {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ECS —Å–∏—Å—Ç–µ–º
    if (m_updateSystem) {
        m_updateSystem->update(m_registry, dt);
    }
}

void GameState::render(sf::RenderWindow& window) {
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ ECS —Å—É—â–Ω–æ—Å—Ç–µ–π
    if (m_renderSystem) {
        m_renderSystem->render(m_registry, window);
    }
}
```

---

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å SFML 3.0

### –ò–∑–º–µ–Ω–µ–Ω–∏—è API

SFML 3.0 –ø—Ä–∏–Ω–µ—Å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è API. –í—Å–µ –æ–Ω–∏ —É—á—Ç–µ–Ω—ã –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

| SFML 2.x | SFML 3.0 | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
|----------|----------|-------------|
| `sf::Rect(x, y, w, h)` | `sf::Rect(position, size)` | –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| `sprite.setPosition(x, y)` | `sprite.setPosition(Vector2f)` | `sf::Vector2f(x, y)` |
| `sprite.setRotation(float)` | `sprite.setRotation(Angle)` | `sf::degrees(rotation)` |
| `sprite.setScale(x, y)` | `sprite.setScale(Vector2f)` | `sf::Vector2f(scaleX, scaleY)` |
| `sf::Sprite()` | `sf::Sprite(texture)` | –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ç—Ä–µ–±—É–µ—Ç —Ç–µ–∫—Å—Ç—É—Ä—É |
| `image.create(size, color)` | `sf::Image(size, color)` | –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –≤–º–µ—Å—Ç–æ create() |
| `rect.width/height` | `rect.size.x/y` | –ò—Å–ø–æ–ª—å–∑—É–µ–º `size` –≤–º–µ—Å—Ç–æ –ø–æ–ª–µ–π |
| `registry.alive()` | `registry.storage<entity>().size()` | –ù–æ–≤—ã–π API EnTT |

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤–∞—è –°—Ü–µ–Ω–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ GameState —Å–æ–∑–¥–∞–µ—Ç—Å—è:
- ‚úÖ 3 —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞ (–∫—Ä–∞—Å–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç —Å –±–µ–ª–æ–π –≥—Ä–∞–Ω–∏—Ü–µ–π)
- ‚úÖ –†–∞–∑–ª–∏—á–Ω—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±—ã
- ‚úÖ –í—Ä–∞—â–µ–Ω–∏–µ —Å —Ä–∞–∑–Ω–æ–π —É–≥–ª–æ–≤–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –°—Ü–µ–Ω–∞—Ä–∏–∏

- [x] –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ —É—Å–ø–µ—à–Ω–∞
- [x] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] ResourceManager –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ–∫—Å—Ç—É—Ä—ã –∏–∑ –ø–∞–º—è—Ç–∏
- [x] RenderSystem —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç —Å–ø—Ä–∞–π—Ç—ã
- [x] UpdateSystem –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–∑–∏—Ü–∏–∏
- [x] –°—á–µ—Ç—á–∏–∫ —Å—É—â–Ω–æ—Å—Ç–µ–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ UI

### –õ–æ–≥–∏ –ó–∞–ø—É—Å–∫–∞

```
[15:20:35.323] [info] Initializing ECS systems
[15:20:35.323] [debug] RenderSystem initialized
[15:20:35.323] [debug] UpdateSystem initialized
[15:20:35.323] [info] Creating test texture
[15:20:35.330] [debug] Texture loaded from image: test_square
[15:20:35.330] [info] Creating test entities
[15:20:35.330] [debug] Created test entity 0 at (200.0, 300.0)
[15:20:35.330] [debug] Created test entity 1 at (350.0, 300.0)
[15:20:35.330] [debug] Created test entity 2 at (500.0, 300.0)
[15:20:35.330] [info] Created 3 test entities
[15:20:35.330] [info] Game scene initialized with ECS
```

---

## –§–∞–π–ª–æ–≤–∞—è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –§–∞–π–ª—ã

```
include/core/
‚îú‚îÄ‚îÄ Components.h                    (–ù–û–í–´–ô) - ECS –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îî‚îÄ‚îÄ systems/
    ‚îú‚îÄ‚îÄ RenderSystem.h              (–ù–û–í–´–ô) - –°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    ‚îî‚îÄ‚îÄ UpdateSystem.h              (–ù–û–í–´–ô) - –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

src/core/
‚îú‚îÄ‚îÄ systems/
‚îÇ   ‚îú‚îÄ‚îÄ RenderSystem.cpp            (–ù–û–í–´–ô) - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ UpdateSystem.cpp            (–ù–û–í–´–ô) - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ CMakeLists.txt                  (–ò–ó–ú–ï–ù–ï–ù) - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã

docs/
‚îî‚îÄ‚îÄ MILESTONE_1_2_ECS_INTEGRATION.md (–ù–û–í–´–ô) - –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –§–∞–π–ª—ã

1. **include/core/ResourceManager.h**
   - –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `loadTextureFromImage()`

2. **src/core/ResourceManager.cpp**
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `loadTextureFromImage()`

3. **include/core/states/GameState.h**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã EnTT registry –∏ —Å–∏—Å—Ç–µ–º—ã
   - –Ø–≤–Ω—ã–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä (–¥–ª—è forward declarations)

4. **src/core/states/GameState.cpp**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ECS —Å–∏—Å—Ç–µ–º
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è update/render —Å ECS

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏

- **–†–∞–∑–º–µ—Ä –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞**: ~2.5 MB (Debug)
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞**: <1 —Å–µ–∫—É–Ω–¥–∞
- **FPS**: 59-60 (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π)
- **UPS**: 59-60 (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ (3 —Å—É—â–Ω–æ—Å—Ç–∏)

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ EnTT

- **Cache-friendly**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–ª–æ—Ç–Ω—ã—Ö –º–∞—Å—Å–∏–≤–∞—Ö
- **–ù—É–ª–µ–≤—ã–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏**: –í hot path (update/render)
- **Compile-time –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: Templates –∏ constexpr
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead**: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω—É–ª–µ–≤–æ–π –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ä—É—á–Ω—ã–º –∫–æ–¥–æ–º

---

## –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

### Milestone 1.3: –¢–∞–π–ª–æ–≤–∞—è –°–∏—Å—Ç–µ–º–∞

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è tmxlite
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ TMX –∫–∞—Ä—Ç
- [ ] –ö–∞–º–µ—Ä–∞ —Å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ–º –∏ –∑—É–º–æ–º
- [ ] –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ (culling)

### –£–ª—É—á—à–µ–Ω–∏—è ECS

- [ ] AnimationComponent –¥–ª—è —Å–ø—Ä–∞–π—Ç-–∞–Ω–∏–º–∞—Ü–∏–∏
- [ ] ColliderComponent –¥–ª—è –∫–æ–ª–ª–∏–∑–∏–π
- [ ] ScriptComponent –¥–ª—è –ø–æ–≤–µ–¥–µ–Ω–∏—è
- [ ] TagComponent –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- [ ] Debug –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] ImGui –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä —Å—É—â–Ω–æ—Å—Ç–µ–π
- [ ] –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ü–µ–Ω—ã
- [ ] Prefab —Å–∏—Å—Ç–µ–º–∞

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Milestone 1.2 —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω! –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è EnTT –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è:
- üéÆ –ì–∏–±–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- üöÄ –í—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üîß –ü—Ä–æ—Å—Ç–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- üì¶ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ç–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã!

---

**–ê–≤—Ç–æ—Ä:** Claude Code
**–î–∞—Ç–∞:** 2025-11-16
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
